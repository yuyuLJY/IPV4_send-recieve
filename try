#include <stdio.h>
#include<string.h>
int main(void) { 
 char a[] = {0x45,0x00 ,0x00, 0x14, 0x00, 0x00, 0x00, 0x00 ,0x40, 0x06,0x00, 0xBC,
    0x0A, 0x00, 0x00, 0x01, 0x0A, 0x00, 0x00, 0x03};
    char *pBuffer = a;
	int i ;
	int sum = 0;
	for (i = 0;i<=(5*2-1)*2;i=i+2){
		sum = sum+((unsigned char)pBuffer[i]<<8)+(unsigned char)pBuffer[i+1];
		printf("当前sum:%x\n",sum);
	}
	if (sum >= 0xFFFF){
		sum = (0xFFFF & sum) + (sum>>16);
	}
	if (sum != 0xffff){ 
	    printf("不是正确的校验和\n");
	}else{
	    printf("校验和正确。输出结果：%x\n",sum);
	}
	return 0;
}

/*
unsigned short sum = 0;   
    unsigned short tempNum = 0;   
    unsigned short headCheckSum = 0;  
  
    //计算checksum  
    for (int i = 0; i < 10; i++){  
        tempNum = ((unsigned char)IPBuffer[i*2]<<8) + (unsigned char)IPBuffer[i*2 + 1];  
        if (0xffff - sum < tempNum)  
            sum = sum + tempNum + 1;  
        else  
            sum = sum + tempNum;  
    }  
    headCheckSum = htons(0xffff - sum); 
*/
